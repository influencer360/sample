import{b as s,c as v}from"./chunk-FW7QGJ5I.js";import{b as y}from"./chunk-PALMNRBQ.js";import{h as E,i as F}from"./chunk-QYNB3KGD.js";import{a as g}from"./chunk-JMUJZFCQ.js";import{b as h,f}from"./chunk-62VJZGPO.js";var r,u,n,p=h(()=>{r=f(y()),u=class{constructor(){this.onKeyDown=t=>{let o=this.getLastElement(),i=this.getFocusableElements();if(i.length){let a=i[0],c=i[i.length-1];if(t.key==="Tab"){t.stopPropagation();let{activeElement:d}=document;t.shiftKey&&(d===a||d===o)?(t.preventDefault(),c.focus()):!t.shiftKey&&d===c&&(t.preventDefault(),a.focus())}}},this.elements=(0,r.List)(),this.nodesFocusedBeforeActivation=(0,r.List)();let e=["button:not([disabled])","[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"]):not([data-is-dropdown-item])'];this.focusableElementsSelector=e.join(",")}addElement(e){this.nodesFocusedBeforeActivation=this.nodesFocusedBeforeActivation.push(document.activeElement),this.elements=this.elements.push(e)}getElementIndex(e){return this.elements.findIndex(t=>t===e)}getElements(){return this.elements}getLastElement(){return this.elements.last()}getFocusableElements(){return this.getLastElement()?.querySelectorAll(this.focusableElementsSelector)}safeFocus(e){e&&e!==document.activeElement&&typeof e.focus=="function"&&e.focus()}focus(){let e=this.elements.last();this.safeFocus(e)}restoreFocus(e){let t=this.nodesFocusedBeforeActivation.get(e);this.nodesFocusedBeforeActivation=this.nodesFocusedBeforeActivation.slice(0,e),this.safeFocus(t)}trapFocus(){this.getLastElement().addEventListener("keydown",this.onKeyDown)}remove(e){if(e){let t=this.getElementIndex(e);t!==-1&&(this.elements.get(t).removeEventListener("keydown",this.onKeyDown),this.elements=this.elements.delete(t),this.restoreFocus(t))}this.elements.forEach(t=>{document.body&&!document.body.contains(t)&&(this.elements=this.elements.delete(this.getElementIndex(t)))})}reset(){this.elements=(0,r.List)(),this.nodesFocusedBeforeActivation=(0,r.List)()}},n=new u});var m,L,l,x=h(()=>{m=f(g());v();F();p();L=E.div`
  outline: none;
`,l=class extends m.default.PureComponent{constructor(e){super(e),this.setEventListeners=this.setEventListeners.bind(this),this.removeEventListeners=this.removeEventListeners.bind(this),this.closeOnEscapeKeyPress=this.closeOnEscapeKeyPress.bind(this)}componentDidMount(){this.setEventListeners()}componentWillUnmount(){this.removeEventListeners()}setEventListeners(){let{features:e,initialFocusedSelector:t}=this.props;if(e.focusManager&&this.dialog)if(n.addElement(this.dialog),t){let o=this.dialog.querySelector(t);n.safeFocus(o),n.trapFocus()}else setTimeout(()=>{let o=n.getFocusableElements();o.length&&(n.safeFocus(o[0]),n.trapFocus())},0);e.escapeExits&&document.addEventListener("keydown",this.closeOnEscapeKeyPress)}removeEventListeners(){let{features:e}=this.props;e.focusManager&&this.dialog&&n.remove(this.dialog),e.escapeExits&&document.removeEventListener("keydown",this.closeOnEscapeKeyPress)}closeOnEscapeKeyPress(e){let{closeModal:t}=this.props;(e.key==="Escape"||e.key==="Esc")&&t(...arguments)}render(){let{children:e,ariaLabel:t,ariaLabelledBy:o,ariaDescribedBy:i}=this.props,a={tabIndex:"-1",role:"dialog","aria-modal":!0,"aria-label":t,"aria-labelledby":o,"aria-describedby":i};return m.default.createElement(L,{ref:c=>{this.dialog=c},...a},e)}};l.defaultProps={features:{ariaTags:!0,escapeExits:!0,focusManager:!0}};l.propTypes={children:s.element.isRequired,features:s.shape({ariaTags:s.bool,escapeExits:s.bool,focusManager:s.bool}),closeModal:s.func,ariaLabel:s.string,ariaLabelledBy:s.string,ariaDescribedBy:s.string,initialFocusedSelector:s.string}});export{l as a,x as b};
//# sourceMappingURL=chunk-BWBYXULB.js.map
