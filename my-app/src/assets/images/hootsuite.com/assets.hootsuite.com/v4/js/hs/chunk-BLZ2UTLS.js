import{b as i,c as Ft,f as Vt}from"./chunk-62VJZGPO.js";var H,st,f,_,N=i(()=>{H=typeof window>"u"?{}:window,st=()=>(H.__doNotUse=H.__doNotUse||{},H.__doNotUse),f=r=>st()[r],_=(r,t)=>{let e=st();return e[r]=t,f(r)}});var nt,ot,it,Bt,jt,D=i(()=>{nt=(r,t)=>{try{let e=new Blob([t],{type:"application/x-www-form-urlencoded"});window?.hs?.isFeatureEnabled("FPLAT_698_NO_SEND_BEACON")?fetch(r,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e}):navigator.sendBeacon(r,e)}catch{}},ot=r=>{try{performance.mark(r)}catch{}},it=r=>{let t=`${r}_MEASURE`;try{performance.measure(t,r);let e=performance.getEntriesByName(t);return e.length?jt(e[0].duration):-1}catch{return-1}finally{Bt(t)}},Bt=r=>{try{performance.clearMeasures(r)}catch{}},jt=r=>r/1e3});var b,ct=i(()=>{D();b=class{constructor(t,e){this.startMarks=new Set,this.name=t,this.histogram=e}getStartMarkId(t){return t?`${this.name}_${t}_START`:`${this.name}_START`}start(t={}){let e=this.getStartMarkId(t.id);this.startMarks.has(e)||(ot(e),this.startMarks.add(e))}end(t={}){let e=this.getStartMarkId(t.id);if(!this.startMarks.has(e))return;this.startMarks.delete(e);let s=it(e);s<0||this.histogram.observe(s,t.labels)}}});function ut(r){return!r.labels||!Object.keys(r.labels).length?"":`${Object.entries(r.labels).map(([e,s])=>`${e}="${s}"`).join(",")}`}function ht(r,t,e="le"){let s="",n=ut(t);return n.length>0?(s+=`${r}_count{${n}} ${t.value.count}
`,s+=`${r}_sum{${n}} ${t.value.sum}
`):(s+=`${r}_count ${t.value.count}
`,s+=`${r}_sum ${t.value.sum}
`),Object.entries(t.value.entries).forEach(([o,c])=>{n.length>0?s+=`${r}_bucket{${e}="${o}",${n}} ${c}
`:s+=`${r}_bucket{${e}="${o}"} ${c}
`}),s}function G(r,t=[]){return r?t.find(e=>zt(e.labels,r)):t[0]}function lt(r,t){let e=` ${t.value.toString()}`;if(t.labels==null||Object.keys(t.labels).length===0)return`${r}${e}
`;let s=ut(t);return`${r}{${s}}${e}
`}function zt(r,t){return!r||!t?!1:at(r).toString()===at(t).toString()}function at(r){return Object.keys(r).sort().map(t=>[t,r[t]])}var F=i(()=>{});var p,qt,V=i(()=>{F();p=class{constructor(){this.data=[]}get(t){return G(t,this.data)}set(t,e){let s=G(e,this.data);return s?s.value=t:this.data.push({labels:e,value:t}),this}collect(t){return this.data.filter(e=>qt(e.labels,t))}resetAll(){return this.data.forEach(t=>{this.reset(t.labels)}),this}},qt=(r,t)=>t?r?Object.keys(t).every(e=>t[e]===r[e]):!1:!0});var g,B=i(()=>{V();g=class extends p{inc(t){return this.add(1,t),this}add(t,e){if(t<0)throw new Error(`Expected increment amount to be greater than -1. Received: ${t}`);let s=this.get(e);return this.set(s?s.value+t:t,e),this}reset(t){this.set(0,t)}}});var y,dt=i(()=>{B();y=class extends g{dec(t){let e=this.get(t);return this.set(e?e.value-1:0,t),this}sub(t,e){let s=this.get(e);return this.set(s?s.value-t:0,e),this}}});function Wt(r,t){if(t<r[r.length-1]){for(let e=0;e<r.length;e+=1)if(t<=r[e])return e}}function j(r){return{entries:r.reduce((e,s)=>(e[s.toString()]=0,e),{"+Inf":0}),sum:0,count:0,raw:[]}}var S,ft=i(()=>{V();S=class extends p{constructor(t=[]){super(),this.buckets=t.sort((e,s)=>e>s?1:-1),this.set(j(this.buckets)),this.observe=this.observe.bind(this)}observe(t,e){let s=this.get(e);s==null&&(s=this.set(j(this.buckets),e).get(e)),s.value.raw.push(t),s.value.entries["+Inf"]+=1;let n=Wt(this.buckets,t);if(n!=null)for(let o=n;o<this.buckets.length;o+=1){let c=s.value.entries[this.buckets[o].toString()];s.value.entries[this.buckets[o].toString()]=c+1}return s.value.sum=s.value.raw.reduce((o,c)=>o+c),s.value.count+=1,this}reset(t){this.set(j(this.buckets),t)}}});var A,pt=i(()=>{B();dt();ft();F();A=class{constructor(){this.data={counter:{},gauge:{},histogram:{}}}validateInput(t,e,s,n){if(String(e)==="")throw new Error("Metric name cannot be empty");if(["counter","gauge","histogram"].indexOf(t)===-1)throw new Error(`Unknown metric type ${t}`);if(typeof s!="string"&&s!=null)throw new Error("help must be string or undefined/null");if(this.data?.[t]?.[e])throw new Error(`A metric with the name '${e}' already exists for type '${t}'`);if(!Array.isArray(n)&&n!=null)throw new Error("buckets must be array or undefined/null")}create(t,e,s="",n=[]){this.validateInput(t,e,s,n);let o;return t==="counter"?(o=new g,this.data.counter[e]={help:s,instance:o,type:t}):t==="gauge"?(o=new y,this.data.gauge[e]={help:s,instance:o,type:t}):(o=new S(n),this.data.histogram[e]={help:s,instance:o,type:t}),o}metrics(){return Object.entries(this.data).reduce((t,[e,s])=>t+Object.keys(s).reduce((n,o)=>{let c=s[o],d=c.instance.collect(),u=n;return c.help.length>0&&(u+=`# HELP ${o} ${c.help}
`),u+=`# TYPE ${o} ${e}
`,u+=d.map(a=>e==="histogram"?ht(o,a):lt(o,a)).reduce((a,O)=>a+O,""),u},""),"")}reset(){return Object.values(this.data).forEach(t=>{Object.values(t).forEach(({instance:e})=>{e.resetAll()})}),this}clear(){return this.data={counter:{},gauge:{},histogram:{}},this}get(t,e){let n=(t!=null?[this.data[t]]:Object.values(this.data)).find(o=>Boolean(o[e]));return n?.[e].instance}}});var gt=i(()=>{});var mt,Et=i(()=>{pt();gt();mt=()=>new A});var $,wt=i(()=>{$=class{constructor(t,e=()=>{}){this.histogram=t,this.updateCb=e}observe(t,e){this.histogram.observe(t,e),this.updateCb()}}});var I,vt=i(()=>{I=class{constructor(t,e=()=>{}){this.counter=t,this.updateCb=e}inc(t){this.counter.inc(t),this.updateCb()}add(t,e){this.counter.add(t,e),this.updateCb()}}});function Yt(r,t){M("Metric name",r),M("Metric help",t)}function Kt(r,t,e){M("Metric name",r),M("Metric help",t),Zt("Histogram buckets",e)}function M(r,t){if(!t)throw new Error(`${r} cannot be empty`)}function Zt(r,t){if(!Array.isArray(t))throw new Error(`${r} must be an array`)}var T,xt=i(()=>{Et();wt();vt();T=class{constructor(t=()=>{}){this.registry=mt(),this.updateCb=t}createHistogram(t,e,s){return Kt(t,e,s),new $(this.registry.create("histogram",t,e,s),this.updateCb)}createCounter(t,e){return Yt(t,e),new I(this.registry.create("counter",t,e),this.updateCb)}popMetrics(){let t=this.registry.metrics();return this.registry.reset(),t}}});var bt=Ft(_t=>{_t.debounce=function(r,t,e){var s,n,o;t===void 0&&(t=50),e===void 0&&(e={});var c=(s=e.isImmediate)!=null&&s,d=(n=e.callback)!=null&&n,u=e.maxWait,L=Date.now(),a=[];function O(){if(u!==void 0){var h=Date.now()-L;if(h+t>=u)return u-h}return t}var X=function(){var h=[].slice.call(arguments),x=this;return new Promise(function(tt,Nt){var Dt=c&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,L=Date.now(),!c){var rt=r.apply(x,h);d&&d(rt),a.forEach(function(Gt){return(0,Gt.resolve)(rt)}),a=[]}},O()),Dt){var et=r.apply(x,h);return d&&d(et),tt(et)}a.push({resolve:tt,reject:Nt})})};return X.cancel=function(h){o!==void 0&&clearTimeout(o),a.forEach(function(x){return(0,x.reject)(h)}),a=[]},X}});var z,yt=i(()=>{z=Vt(bt())});var m,E,l,U,Jt,Qt,q=i(()=>{m="production",E="staging",l="dev",U=()=>{let r=Qt(),t=String(Jt().env||r.TARGET||r.NODE_ENV).toLowerCase();return t.includes("dev")?l:t.includes("stag")?E:m},Jt=()=>typeof hs<"u"?hs:{},Qt=()=>typeof process<"u"&&process.env?process.env:{}});var Xt,te,ee,re,se,ne,St,oe,ie,W,v,Y=i(()=>{yt();q();D();Xt="https://agg-pushgw-external.dev.hootdev.com",te="https://agg-pushgw-external.staging.hootops.com",ee="https://agg-pushgw-external.prod.hootops.com",re="https://development-platform.hootsuite.com",se="https://staging-platform.hootsuite.com",ne="https://platform.hootsuite.com",St=window?.hs?.isFeatureEnabled("FPLAT_579_USE_PUBLIC_URL")?{[m]:ne,[E]:se,[l]:re}:{[m]:ee,[E]:te,[l]:Xt},oe=St[U()]||St[l],ie=500,W=class{setRegistry(t){this.registry=t}},v=class extends W{constructor(){super(),this.send=(0,z.debounce)(this.send,ie)}send(){nt(`${oe}/metrics/frontend`,this.registry.popMetrics())}}});var C,At=i(()=>{ct();xt();Y();C=class{constructor(t,e){this.timers={},this.histograms={},this.counters={},this.namespace=t,this.backend=e?.backend||new v,this.registry=e?.registry||new T(()=>this.sendToBackend()),this.backend.setRegistry(this.registry)}getHistogramTimer(t,e,s){let n=this.getFullMetricName(t);return this.timers[n]||(this.timers[n]=new b(n,this.registry.createHistogram(n,e,s))),this.timers[n]}getHistogram(t,e,s){let n=this.getFullMetricName(t);return this.histograms[n]||(this.histograms[n]=this.registry.createHistogram(n,e,s)),this.histograms[n]}getCounter(t,e){let s=this.getFullMetricName(t);return this.counters[s]||(this.counters[s]=this.registry.createCounter(s,e)),this.counters[s]}sendToBackend(){this.backend.send()}getFullMetricName(t){return`fe_${this.namespace}_${t}`.toLowerCase()}}});var K,$t=i(()=>{N();At();Y();K=(r,t)=>{let e=`performanceMetrics_${r.toUpperCase()}`;return f(e)||_(e,new C(r,t))}});function It(r,t){if(typeof r!="function"||t!=null&&typeof t!="function")throw new TypeError("Expected a function");let e=new Map;return function(...n){let o=t?t.apply(this,n):n[0];if(e.has(o))return e.get(o);let c=r.apply(this,n);return e.set(o,c),c}}var Tt=i(()=>{});var Z,Mt=i(()=>{Tt();Z=It});var Ut,ce,Ct,w,R,P=i(()=>{$t();Mt();Ut="hs_app",ce=[.25,.5,1,1.5,2,2.5,3,5,7,10],Ct=Z(r=>{let t=K(Ut).getHistogramTimer("bundle_load_seconds","Time to load an HS app bundle",ce);return t.start({id:r}),(e=!1)=>{t.end({id:r,labels:{hsApp:r,hasError:e.toString()}})}});(function(r){r.MISSING_HS_APP_URLS="missing_hsAppUrls",r.MISSING_APP_INFO="missing_appInfo",r.SCRIPT_ONERROR="script_onerror",r.FAILED_TO_FETCH_BUNDLE_URL="failed_to_fetch_bundle_url"})(w||(w={}));R=Z((r,t)=>{let e={reason:r};t&&(e.hsApp=t),K(Ut).getCounter("bundle_load_error_total","Counter for bundle load errors").inc(e)})});function Rt({name:r,url:t,reset:e=!1}){let s=`fe-lib-async-app-bundle-${r}`,n=document.getElementById(s);if(n)if(e)n.remove();else return;let o=document.createElement("script");o.src=t,o.id=s,o.onerror=()=>R(w.SCRIPT_ONERROR,r),o.async=!0,document.head.appendChild(o)}var Pt=i(()=>{P()});function Lt(){let r=U();if(!kt[r])throw new Error(`Unsupported env: "${r}"`);return kt[r]}var kt,Ot=i(()=>{q();kt={[m]:"https://i.hootsuite.com",[E]:"https://staging-i.hootsuite.com",[l]:"https://development-i.hootsuite.com"}});function ae(r){return document.cookie.split(";").find(t=>t.trim().startsWith(`${r}=`))?.split("=").map(decodeURIComponent)[1]||null}async function J(r){let t=ae(r);if(t!==null)return t;let e=`${Lt()}/async-apps/via/${r}.txt`;return fetch(e).then(s=>{if(!s.ok)throw new Error(`Error fetching ${e}: [${s.status}] ${s.text}`);return s.text()}).then(s=>s.trim())}function ue(r){let t={};return r.reduce((e,s)=>(e[s]=J(s),e),t)}var k,Ht=i(()=>{Pt();P();Ot();k=class{constructor(t){this.registeredApps={},this.pendingResolves={},this.addPendingResolve=(e,s)=>{this.pendingResolves[e]||(this.pendingResolves[e]=[]),this.pendingResolves[e].push(s)},this.firePendingResolves=(e,s)=>{this.pendingResolves[e]&&this.pendingResolves[e].forEach(n=>n(s)),delete this.pendingResolves[e]},this.registerHsApp=(e,s)=>{this.registeredApps[e]=s,this.firePendingResolves(e,s)},this.getHsApp=e=>(this.hsAppUrls[e]||(this.hsAppUrls[e]=J(e)),new Promise(s=>{this.hsAppUrls[e].catch(()=>(R(w.FAILED_TO_FETCH_BUNDLE_URL),this.hsAppUrls[e]=J(e),this.hsAppUrls[e])).then(n=>{this.addPendingResolve(e,s),this.registeredApps[e]?this.firePendingResolves(e,this.registeredApps[e]):Rt({name:e,url:n})})})),this.hsAppUrls={},t&&(this.hsAppUrls=ue(t))}}});function le(){return f(Q)}async function vr(r){let t=le();if(t)if(window?.hs?.isFeatureEnabled("FPLAT_622_MEASURE_BUNDLE_TIME")){let e=Ct(r);try{let s=await t.getHsApp(r);return e(),s}catch(s){throw e(!0),s}}else return t.getHsApp(r);else return Promise.reject(he)}function xr(r){f(Q)||_(Q,new k(r))}var Q,he,de=i(()=>{N();P();Ht();Q="hsAppsV3",he="Apps loader singleton not found."});export{bt as a,vr as b,xr as c,de as d};
//# sourceMappingURL=chunk-BLZ2UTLS.js.map
