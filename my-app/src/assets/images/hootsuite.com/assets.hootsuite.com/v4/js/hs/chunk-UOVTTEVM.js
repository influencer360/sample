import{a as m,b as C,c as R}from"./chunk-EP65TB4K.js";import{a as y}from"./chunk-XVF4SJQS.js";import{a as b,c as V,d as _,e as v,h as E,i as U,j as x,l as F,m as D,n as L,o as I,p as d}from"./chunk-K3V6P2YE.js";import{a as O}from"./chunk-QG2RGRKZ.js";import{c as $,h as ee,i as z,k as oe}from"./chunk-XVCZZZAI.js";import{a as n}from"./chunk-ETGVIKWH.js";import{b as j,d as W,e as g,g as Z,k as P,n as T,s as J}from"./chunk-S3IS3DRO.js";import{b as k}from"./chunk-OZL6K2YT.js";import{a as Q}from"./chunk-TTZU5XJQ.js";import{b as S,c as X}from"./chunk-BRMHBYYL.js";import{b as M}from"./chunk-INSRYSWJ.js";import{b as A,c as Y}from"./chunk-RBJWJTV5.js";import{a as q}from"./chunk-5M6X2SDJ.js";import{f as h}from"./chunk-62VJZGPO.js";var u=h(q()),l=h(M());Y();X();var N=h(M());var B={authorize:function(e,o){N.default.emit("socialNetwork:authorize:command",e,o)},triggerAuthComplete:function(e){var o={useRedirect:!0,triggerData:e},r=O.getSocialNetworkFromType(e.source);this.authorize(r,o)},addAccount:function(e,o,r){N.default.emit("socialNetwork:addAccount:command",e,o,r)},deleteAccount:function(e,o){N.default.emit("socialNetwork:deleteAccount:command",e,o)},refreshNetworks:function(e){N.default.emit("socialNetwork:refresh:command",e)}};d();d();d();d();d();d();d();d();d();Z();J();var w=h(ee()),p=h($());V();var G=h(Q());oe();var re=45,te=104,se=120,H=(0,G.default)({YOUTUBECHANNEL:null,PINTEREST:null}),ie=e=>b(hs.facadeApiUrl+"/v2.0/social-profiles?splitPrivateProfiles=true","GET",{data:{includeSuggested:!0,includeTeams:!0,organizationId:e},credentials:"include"}).then(o=>{let r=o.data,s=null,i=[];if(Array.isArray(r.socialProfiles)){let f=t=>r.socialProfiles.filter(a=>t&&Array.isArray(t.socialProfileIds)&&t.socialProfileIds.includes(a.socialProfileId));Array.isArray(r.suggested)&&(s=r.suggested.filter(a=>a.socialProfileIds).map(a=>({socialProfiles:f(a)})).filter(a=>a.socialProfiles.length>0)),Array.isArray(r.teams)&&(i=r.teams.filter(t=>(t.socialProfiles=f(t),t.socialProfiles=t.socialProfiles.filter(a=>a.socialProfileType!==H.YOUTUBECHANNEL&&a.socialProfileType!==H.PINTEREST),t.socialProfileIds=t.socialProfiles.map(a=>a.socialProfileId),t.socialProfileIds.length>0&&t.socialProfiles.length>0)))}return{privateSocialProfiles:r.privateSocialProfiles,socialProfiles:r.socialProfiles,suggestedNetworks:s,teams:i}}),Re=y.extend({messageEvents:{"socialNetwork:addNetwork:instagramType":"selectInstagramType","socialNetwork:addNetwork:modal":"showAddNetworkModal","socialNetwork:addNetwork:close":"closeAddNetworkModal","socialNetwork:addNetwork:direct":"addNetworkDirectly","socialNetwork:showPaywall:tiktokbusiness":"showTikTokBusinessPaywallModal","socialNetwork:transfer:modal":"showTransferModal","socialNetwork:socialNetworkExpiration:modal":"showSocialNetworkExpirationModal","socialNetwork:deleteNetwork:action":"onDeleteAction","socialNetwork:sync:action":"onSyncAction","socialNetwork:authorize:error":n.displayError,"socialNetwork:addAccount:success":"onAddAccountSuccess","socialNetwork:addAccount:error":"onAddAccountError","socialNetwork:addAccount:complete":"onAddAccountComplete","socialNetwork:addAccount:transfer":"renderTransferModal","socialNetwork:transfer:success":"onAccountTransferSuccess","socialNetwork:transfer:error":"onTransferError","socialNetwork:reauthorize:success":n.displaySuccess,"socialNetwork:reauthorize:error":n.displayErrorIfDefined,"socialNetwork:loadingIdentities":n.displayLoading,"socialNetwork:delete:success":"onDeleteSuccess","socialNetwork:delete:error":n.displayError},isModalShowing:!1,getPrivateAccountAmount:function(){if(typeof window.hs=="object")return Object.values(window.hs.socialNetworks).filter(({ownerType:e})=>e==="MEMBER").length},instagramAddFlow:function(e){let o=z("CI_3360_DISABLE_ADD_IG_PERSONAL"),r=!hs?.dashboardState;o&&r?l.default.emit("socialNetwork:addNetwork:igbAuthProcess",e):m.SelectInstagramProfileTypeModal(e)},selectInstagramType:function(e){g().then(o=>{!T()||o?this.instagramAddFlow(e):n.displayError({message:A._("You\u2019ve already connected %d social accounts. [Link]Upgrade your plan[/Link] to manage additional accounts and save more time.").replace("%d",this.getPrivateAccountAmount()).replace("[Link]",'<a href="https://www.hootsuite.com/plans/upgrade">').replace("[/Link]","</a>")})})},showAddNetworkModal:function(e){g().then(o=>{let r=!T();P()&&!o?r&&this.showAddNetworkModalWorker(e):this.showAddNetworkModalWorker(e)})},showAddNetworkModalWorker:function(e){e=e||{},this.addOptions=e;var o=this;S.promiseRealSuccess(ajaxCall({url:"/ajax/network/add",type:"GET",data:{organizationId:e.organizationId}},"q1")).done(function(r){o.addModal=m.AddSocialAccountModal(r,e)}).fail(function(r,s,i,f){i!=="Forbidden"&&n.displayError(f)})},closeAddNetworkModal:function(){this.addModal&&this.addModal.close(),this.addModal=null},setModalParams:function(e){this.modalParams=e},showTikTokBusinessPaywallModal:function(){m.TikTokBusinessPaywallModal()},showTransferModal:function(e,o){var r=this;S.promiseRealSuccess(ajaxCall({url:"/ajax/network/transfer-popup",data:{socialNetworkId:e}},"q1")).done(function(s){u.default.extend(o,{createTab:!s.ignoreNewTab,saveCheckbox:!0,isUsedForMemberAuth:s.isUsedForMemberAuth}),r.renderTransferModal(s,null,o)}).fail(function(s,i,f,t){t.errorMessage=t.errorMsg,n.displayError(t)})},showSocialNetworkExpirationModal:function(){S.promiseRealSuccess(ajaxCall({url:"/ajax/network/get-expired-social-networks",data:"includeDismissed=true&prioritizeActionableProfiles=true"},"q1")).done(function(e){l.default.emit("overlay:init","modal","socialNetworkExpirationModal",{data:e})}).fail(function(e,o,r,s){n.displayError(s)})},addNetworkDirectly:function(e,o){this.addOptions=o;var r=u.default.pick(o,"organizationId","uiContext");l.default.emit("socialNetwork:authorize:command",e,r)},onAddAccountSuccess:function(e,o){var r=!!e.authSuccessOne&&(hs.dashboardState==="organizations"||hs.dashboardState==="home")&&(o.toUpperCase()!==I||o.toUpperCase()===I&&hs.isFeatureEnabled("CI_4310_WHATSAPP_AUTH_SUCCESS"));if(o.toUpperCase()===E&&e.finishWithoutCompletingExtendedAuth?n.displayWarning({message:A._("The Instagram profile you\u2019ve connected has limited functionality until you connect it to your business page in Facebook.")}):r?m.AuthSuccessModal(e.authSuccessOne):this.displaySuccess(),o.toUpperCase()==x||o.toUpperCase()==D||o.toUpperCase()==E||o.toUpperCase()==U||o.toUpperCase()==v||o.toUpperCase()==F||o.toUpperCase()==_||o.toUpperCase()==L){var s=this.addOptions||{},i=u.default.pick(s,"onSuccess","onComplete");i&&typeof i.onComplete<"u"&&i.onComplete(),i&&typeof i.onSuccess<"u"&&e.socialNetworkId&&e.success&&i.onSuccess(e)}this.addOptions=null,(!e||!e.isMultiIdentity)&&this.closeAddNetworkModal(),l.default.emit("socialNetwork:refresh:command"),this.accountAddSuccessFollowup(e,o)},onAddAccountError:function(e){switch(e.errorCode){case re:l.default.emit("overlay:init","modal","unableToShareSN",u.default.pick(e,"socialNetworkName","socialNetworkOwnerName"));break;case te:Promise.all([j(),W(),g()]).then(o=>{let r=o[0],s=o[1],i=o[2];P()?(r!=="FREE"||s>2||i)&&(e.feature="SOCIAL_NETWORKS",dashboard.showFeatureAccessDeniedPopup(e,function(){})):(e.feature="SOCIAL_NETWORKS",dashboard.showFeatureAccessDeniedPopup(e,function(){}))});break;case se:m.IgbStealDowngradeErrorModal(e.options);break;default:n.displayErrorIfDefined(e)}},accountAddSuccessFollowup:function(e,o){switch(o=o.toUpperCase(),o){case k.c.INSTAGRAM:var r=e&&typeof e.extendedAuthFlow<"u"&&e.extendedAuthFlow.networkType===k.c.INSTAGRAMBUSINESS,s=!!e.finishWithoutCompletingExtendedAuth;r&&!s&&l.default.emit("overlay:init","modal","extendedAuthFlowSuccess",e.extendedAuthFlow);break;case k.c.TWITTER:if(hs.isFeatureEnabled("ADS_707_ACTIVATE_TWITTER")&&e&&e.uiContext===C.ADS){var i=hs.util.getUrlRoot()+"/hsads/twitter-authorize?snId="+encodeURIComponent(e.socialNetworkId);window.open(i,R.generateEventId("twitter"))}break}var f=document.querySelector(".rc-FullScreenComposer");if(f){var t=w.default.getStore(p.ORGANIZATIONS),a=t.getSelectedOrganization();try{var K=ie(a&&a.organizationId);K.then(function(c){c.socialProfiles&&c.suggestedNetworks&&(w.default.getActions(p.SOCIAL_NETWORK_PROFILES).setSocialProfiles(c.socialProfiles),w.default.getActions(p.SOCIAL_NETWORK_PROFILES).setSuggestedNetworks(c.suggestedNetworks)),c.privateSocialProfiles&&w.default.getActions(p.SOCIAL_NETWORK_PROFILES).setPrivateSocialProfiles(c.privateSocialProfiles),c.teams&&w.default.getActions(p.SOCIAL_NETWORK_PROFILES).setTeamProfiles(c.teams)})}catch{hs.statusObj.update(A._("Unable to fetch social profiles"),"error",!0)}}},renderTransferModal:function(e,o,r){this.transferModal&&this.transferModal.close&&this.transferModal.close();var s=this.addOptions?u.default.pick(this.addOptions,"onSuccess","onComplete"):{};this.transferModal=new m.TransferNetworkModal(this.getModalOptions(e,s,r)),this.transferModal.render()},getModalOptions:function(e){var o=Array.prototype.slice.call(arguments);return o.splice(0,1,{data:e}),u.default.isObject(this.modalParams)&&o.push({params:this.modalParams}),u.default.extend.apply(null,o)},onAccountTransferSuccess:function(e){this.displaySuccess(),this.transferModal&&this.transferModal.close(),this.transferModal=null,this.closeAddNetworkModal(),l.default.emit("socialNetwork:refresh:command"),typeof e<"u"&&typeof e.snType<"u"&&this.accountAddSuccessFollowup(e,e.snType)},onTransferError:function(e){n.displayErrorIfDefined(e),this.transferModal&&this.transferModal.close(),this.transferModal=null},onDeleteAction:function(e,o){o=o||{},hs.statusObj.update(A._("Deleting network..."),"info"),o.onComplete=u.default.bind(hs.statusObj.reset,hs.statusObj),B.deleteAccount(e,o)},onDeleteSuccess:function(){l.default.emit("socialNetwork:refresh:command")},onSyncAction:function(e,o){n.displayLoading(),l.default.emit("socialNetwork:sync:command",e,o)},displaySuccess:function(){this.isModalShowing||n.displaySuccess()}});export{B as a,Re as b};
//# sourceMappingURL=chunk-UOVTTEVM.js.map
